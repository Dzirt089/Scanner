# Scanner - приложение \ служба для прослушивания сканеров штрих-кодов, через USB COM порт (Виртуальный, через донгл)
Применяется паттерн производитель - потребитель (Producer - Consumer).
# SerialScannerHostedService (COM - PortListener - Channel) - ScanProcessingHostedService (Channel - IScanProcessor - write BD\UI)
SerialScannerHostedService и ScanProcessingHostedService - фоновые процессы.
# PortListener - делает фрейминг по \r\n, т.е. выделяет законченные сообщения из непрерывного потока байтов по \r\n.Для чего? Потому что событие DataReceived приходит не на UI-потоке и не гарантирует целостность строк. Например:
Приложение может получить его частями:

    "Hello\r\nWo"

    "rld\r\nHow are"

    " you?\r\n"

Без фрейминга вы не сможете понять, где заканчивается одно сообщение и начинается следующее. С фреймингом по \r\n вы правильно разделите поток на три сообщения:

    "Hello"

    "World"

    "How are you?"
 
Глобальной очередью сообщений в проекте служит Канал (Channel). Из System.Threading. Он потокобезопасен и настраиваемый.

# SerialScannerHostedService - авто-обнаружение портов, плюс watchdog(сторожевой таймер): если порт "залип" (давно нет данных) — пересоздадим listener
Его работа, в цикле раз в N-секунд получать все существующие COM-порты на данный момент времени.
Затем перебирает полученные порты с целью, добавить или обновить слушатель порта (PortListener), 
передав ему номер порта и канал для записи данных (он производитель паттерна "Производитель - потребитель")

Добавление или обновление слушателей портов происходит в потокобезопасный словарь (ConcurrentDictionary), для того, чтобы существующие порты не перепсывали\ не затирали себя. 

Также происходит удаление исчезнувших портов со слушателями, при отсутствии физического порта в системе компьютера. 
Чтобы при обнаружении его, снова поднять новый слушатель.

